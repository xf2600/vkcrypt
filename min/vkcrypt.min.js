var Aes,VKCrypt,_gaq;
(function(){function h(){var a=document.getElementsByClassName("im_editable")[0];a||(a=document.getElementsByClassName("im_editable")[1]);a||(a=document.getElementById("mail_box_text"));return a}function j(a,b){var c=a.value;a.textContent?a.textContent=b:c&&(a.value=b)}function l(){_gaq=[["_setAccount","UA-26518084-2"],["_trackPageview"]];var a=window.onerror;window.onerror=function(b,c,d){_gaq.push(["_trackEvent","JS Error",b,navigator.userAgent+" -> "+c+" : "+d]);"function"===typeof a&&a();return!0}}
function k(a,b){for(var c,d,e=localStorage.getItem(f)||VKCrypt.setKey(),g=0;g<a.length;g++)d=a[g].getElementsByClassName("im_log_body")[0],d=d.firstChild,(c=d.getElementsByClassName("im_log_author_chat_name")[0])&&d.removeChild(c),c=d.textContent,c=b?Aes.Ctr.encrypt(c,e,256):Aes.Ctr.decrypt(c,e,256),d.textContent=c}var f="vkcrypt-key";if(!_gaq&&!document.getElementById("https://google-analytics.com/ga.js")){var e=document.createElement("script");e.id=e.src="https://google-analytics.com/ga.js";e.onload=
l;document.body.appendChild(e)}document.addEventListener("keydown",function(){if(event.altKey)switch(event.keyCode){case 68:VKCrypt.decrypt();event.preventDefault();break;case 69:VKCrypt.encrypt();event.preventDefault();break;case 83:VKCrypt.setKey(),event.preventDefault()}},!1);VKCrypt={encrypt:function(){var a=document.getElementsByClassName("im_sel_row");if(a.length)k(a,!0);else{var a=h(),b=localStorage.getItem(f)||VKCrypt.setKey(),b=Aes.Ctr.encrypt(a.textContent||a.value,b,256);j(a,b)}},decrypt:function(){var a=
document.getElementsByClassName("im_sel_row");if(a.length)k(a,!1);else{var a=h(),b=localStorage.getItem(f)||VKCrypt.setKey(),b=Aes.Ctr.decrypt(a.textContent||a.value,b,256);j(a,b)}},setKey:function(){var a=localStorage.getItem(f),a=prompt("\u041a\u043b\u044e\u0447: ",a||"")||a||"";localStorage.setItem(f,a);return a}}})();
